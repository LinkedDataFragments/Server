#!/usr/bin/env node
/*! @license MIT Â©2013-2016 Ruben Verborgh, Ghent University - imec */
/* Standalone Linked Data Fragments Server */

var _ = require('lodash'),
    fs = require('fs'),
    path = require('path'),
    startCLI = require('../lib/abstractCLI');

// Parse arguments
var args = process.argv.slice(2);
if (args.length < 1 || args.length > 3 || /^--?h(elp)?$/.test(args[0])) {
  console.log('usage: server config.json [port [workers]]');
  return process.exit(1);
}
var configDefaults = JSON.parse(fs.readFileSync(path.join(__dirname, '../config/config-defaults.json'))),
    config = _.defaults(JSON.parse(fs.readFileSync(args[0])), configDefaults);

config.port = parseInt(args[1], 10) || config.port;
config.workers = parseInt(args[2], 10) || config.workers;

startCLI(config, console);
